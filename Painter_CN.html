<html>
<head>
<title>MyHtml.html</title>

<meta name="keywords" content="keyword1,keyword2,keyword3">
<meta name="description" content="this is my page">
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<script type="text/javascript" src="jquery-ui-1.11.0.custom/external/jquery/jquery-1.11.0.js"></script>
<link rel="stylesheet" href="jquery-ui-1.11.0.custom/jquery-ui.css" />
<link rel="stylesheet" href="jquery-ui-1.11.0.custom/jquery-ui.structure.css" />
<link rel="stylesheet" href="colorpicker-master/jquery.colorpicker.css" />
<link rel="stylesheet" href="jquery-ui-1.11.0.custom/jquery-ui.theme.css" />
<script type="text/javascript" src="jquery-ui-1.11.0.custom/jquery-ui.js"></script>
<script type="text/javascript" src="js/anyLine.js"></script>
<script type="text/javascript" src="colorpicker-master/jquery.colorpicker.js"></script>
<script type="text/javascript" src="colorpicker-master/parts/jquery.ui.colorpicker-rgbslider.js"></script>
<script type="text/javascript" src="formulaeditor/js/FEditor.js"></script>
<script type="text/javascript" src="formulaeditor/lib/mathquill-0.10.1/mathquill.js"></script>
<script type="text/javascript" src="formulaeditor/lib/mathquill-0.10.1/mathquill.min.js"></script>
<script type="text/javascript" src="js/json2.js"></script>
<script type="text/javascript" src="js/funcImage.js">j= $;</script>
<script type="text/javascript" src="js/canvas.js"></script>

<style type="text/css">
* {
	font-family: '微软雅黑';
	font-size:12px;
}

canvas {
	border: 2px dashed gray;
}

.container_pencil{
	cursor: url(images/PencilToolCursor.gif), pointer;
}

.container_eraser{
	cursor: url(images/test.png), pointer;
}

.container_font{
	cursor:crosshair;
}
.speed {
	top: 15px;
}

.ui-selectmenu-text {
	font-size: 12px;
}

#div-img{
    width: 1000px;
    height: 400px;
    background: white;
}

</style>
</head>

<body oncontextmenu="javascript:return false">
<div id="dialog" title="作图工具">
	<div style="font-size:14px;"> 
	   <fieldset style="float:left;width:300px;">
	        <legend>工具</legend>
				<div id="toolsOptions">
					<input type="radio" id="tools_pencil" name="toolsOption" checked="checked"><label for="tools_pencil">画笔</label> &nbsp;
					<input type="radio" id="tools_eraser" name="toolsOption" ><label for="tools_eraser">橡皮擦</label> &nbsp;
					<input type="radio" id="tools_trash" name="toolsOption"><label for="tools_trash">清空</label>
					<div style="border-top:1px dashed gray;margin-top:8px;padding-top:8px;"><span>
						<button id="tools_save">保存为图片</button>&nbsp;&nbsp;&nbsp;
						<button id="tools_undo">上一步</button>&nbsp;&nbsp;&nbsp;
						<button id="tools_redo">下一步</button>
					</span></div>
				</div>
		</fieldset>
        <fieldset style="float:left;">
            <legend>形状</legend>
            <div><span>
                <input type="radio" id="tools_line" name="toolsOption"><label for="tools_line">直线</label>
                <input type="radio" id="tools_dottedline" name="toolsOption"><label for="tools_dottedline">虚线</label>
                <div style="border-top:1px dashed gray;margin-top:8px;padding-top:8px;"><span>
                <input type="radio" id="tools_rectangle" name="toolsOption"><label for="tools_rectangle">矩形</label>
                <input type="radio" id="tools_circle" name="toolsOption"><label for="tools_circle">文字</label>
                </span></div>
            </span></div>
        </fieldset>

        <fieldset style="float:left;width:180px;">
        <legend>线条设置</legend>
        <span style="float: left;margin-top: 6px;">线条粗细: </span>
             <select id="penWidth" >
                 <option value="1" selected>1px</option>
                 <option value="2">2px</option>
                 <option value="4">4px</option>
                 <option value="6">6px</option>
                 <option value="8">8px</option>
                 <option value="12">12px</option>
                 <option value="14">14px</option>
                 <option value="16">16px</option>
                 <option value="18">18px</option>
             </select>
            <div style="border-top:1px dashed gray;margin-top:8px;padding-top:8px;">
        <span>边框色:<input id="colorpicker-popup" type="text"  value="000000" style="width: 72px;display:none; "></span>&nbsp;
        <span>填充色:<input id="colorpicker-popup2" type="text"  value="fe9810" style="width: 72px;display:none; "></span>
        </div>
        </fieldset>

        <fieldset style="float:left;width:160px;">
	        <legend>字体设置</legend>
	        <span><span style="float: left;margin-top: 6px;">字体大小: </span>
	        		<select id="fontSize"  >
		                 <option value="8px" selected>8px</option>
		                 <option value="10px">10px</option>
		                 <option value="12px">12px</option>
		                 <option value="14px">14px</option>
		                 <option value="16px">16px</option>
		                 <option value="18px">18px</option>
		                 <option value="20px">20px</option>
		                 <option value="22px">22px</option>
		                 <option value="24px">24px</option>
		                 <option value="26px">26px</option>
		                 <option value="28px">28px</option>
		                 <option value="30px">30px</option>
		                 <option value="32px">32px</option>
		                 <option value="34px">34px</option>
		                 <option value="36px">36px</option>
	             </select>
	        <span><span style="float: left;margin-top: 6px;">字体选择:</span>
	        		<select id="fontType" style="top:20px;" >
		                 <option value="宋体" >宋体</option>
		                 <option value="微软雅黑">微软雅黑</option>
		                 <option value="仿宋">仿宋</option>
		                 <option value="Arial" selected>Arial</option>
		                 <option value="Consolas">Consolas</option>
	             </select>
            <span style="font-weight:bold;"><input type="checkbox" id="boldOption" name="fontOption"><label for="boldOption">B</label></span></span>
	        <span style="font-style: italic;"><input type="checkbox" id="italicOption" name="italicOption"><label for="italicOption">I</label></span></span>
        </fieldset>

        <fieldset style="float:left;width:160px;">
            <legend>画笔绘图</legend>
            <div style="background:white;position:relative;" id="container">
            <div id="temp" style="border:1px solid gray;width:1px;height:1px;position:absolute;display:none;"></div>
            <canvas id="myCanvas" width="1000" height="400" class="container_pencil"></canvas>
            </div>
        </fieldset>
    </div>

    <fieldset style="float:left;">
        <legend>根据函数绘图</legend>
        <button id="tools_save1">保存为图片</button>
        <span></span>
        <button id='addfunc' onclick="Add()">添加函数</button>
            <div id="function">
                <span id="mod" style="display:none" name="0">
                   <input type="color"/> y=

                       <span style="margin-left:120px;width:18px;overflow:hidden;">
                           <select  style="width:50px;margin-left:-115px;" onchange="$(this).parent().next().val($(this).val())">
                           <option value="x">eg1</option>
                           <option value="x^2">eg2</option>
                           <option value="x^3">eg3</option>
                           <option value="sin(x)">eg4</option>
                           <option value="cos(x)">eg5</option>
                           </select></span>
                           <input type="text" name="Fun"  placeholder="请从左侧列表选择或手动输入一个函数：" style="width:30%;height:20px;border:1pt;border-radius:5px;outline:none">
                           <button onclick="Delete(this.parentNode)">Delete</button>
                           <input type="checkbox" onclick="reDraw()" checked="checked"/>Draw Line
                </span>
            </div>

                    <!--&lt;!&ndash;这里是input框，定位到select的上面&ndash;&gt;-->
                    <!--<span  style="position:relative;width:20%;height:28px;border-radius:5px;">-->
                    <!--<input type="text" name="Fun" id="qlc_zdz" class="Fun" placeholder="可选择也可输入的下拉框" style="width:20%;height:24px;border:0pt;border-radius:5px;outline:0">-->
                    <!--</span>-->


            <div style="border-top:1px dashed rgba(0,0,0,0.26);margin-top:8px;padding-top:8px;"><span>
            </span></div>
            <div id="option">
                X：<input id="xLeftValue" /> ~<input id="xRightValue" /><br>
                Y：<input id="yLeftValue" /> ~<input id="yRightValue" /><br>
                <span id="show-size">Size:</span>
            </div>
            <button onclick="change()">显示函数图像</button>

            <div id="div-img">
               <canvas id="graph" ></canvas>
            </div>
    </fieldset>
    </div>


        <div style="clear:both;"></div>
    </div>
</div>
</body>

    <span id="show" style="display:none;"></span>
	<script>
		const FONT_STYLE = "10px 黑体";
		const MIN = 1e-4;
		const MAX = 1e8;
		const EPS = 1e-12;
		const CANVAS = j("graph");
		const CONTEXT_2D = CANVAS.getContext("2d");
		const FUN_IMG_WIDTH = CANVAS.parentNode.clientWidth;
		const FUN_IMG_HEIGHT = CANVAS.parentNode.clientHeight;
		var xLeftValue = -FUN_IMG_WIDTH / 100; // x最左的值
		var xRightValue = FUN_IMG_WIDTH / 100;
		var yLeftValue = -FUN_IMG_HEIGHT / 100;
		var yRightValue = FUN_IMG_HEIGHT / 100;
		var tableX, tableY, countX, countY;
		var funStage = 0,
			mouseX, mouseY;
		var tmp;
	</script>
	<script>
		CANVAS.width = FUN_IMG_WIDTH;
		CANVAS.height = FUN_IMG_HEIGHT;
		j("show-size").innerHTML = "Size：" + FUN_IMG_WIDTH + "*" + FUN_IMG_HEIGHT;

		CANVAS.onmousedown = function(ob) {
			mouseX = ob.layerX;
			mouseY = ob.layerY;
			funStage = 1;
		}
		CANVAS.onmousemove = function(ob) {
			if(funStage != 1) {
				return;
			}
			var NoX, NoY, det;
			NoX = ob.layerX;
			NoY = ob.layerY;
			det = (mouseX - NoX) / FUN_IMG_WIDTH * (xRightValue - xLeftValue);
			xLeftValue += det;
			xRightValue += det;
			det = (NoY - mouseY) / FUN_IMG_HEIGHT * (yRightValue - yLeftValue);
			yLeftValue += det;
			yRightValue += det;
			mouseX = NoX;
			mouseY = NoY;
			reDraw();
			update();
		}
		CANVAS.onmouseup = function(ob) {
			if(funStage == 1) {
				funStage = 0;
				reDraw();
			}
		}
		CANVAS.onmouseleave = function(ob) {
			if(funStage == 1) {
				funStage = 0;
				reDraw();
			}
		}
		CANVAS.onmousewheel = function(ob) {
			// 取消事件的默认动作
			ob.preventDefault();
			// 放大的比例
			var ScaleRate = 0.9;
			var detail;
			if(ob.wheelDelta) {
				detail = ob.wheelDelta;
			} else if(ob.detail) {
				detail = ob.detail;
			}
			if(detail > 0) {
				scale(ob.layerX, FUN_IMG_HEIGHT - 1 - ob.layerY, ScaleRate);
			} else {
				scale(ob.layerX, FUN_IMG_HEIGHT - 1 - ob.layerY, 1 / ScaleRate);
			}
			reDraw();
			update();
		}
		// 初始化
		reDraw();
		update();
		Add();
	</script>

</html>